---
title: "15 Insights from Florida Assessment Data"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{15 Insights from Florida Assessment Data}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  message = FALSE,
  warning = FALSE,
  fig.width = 8,
  fig.height = 5,
  cache = TRUE
)
```

```{r load-packages}
library(flschooldata)
library(dplyr)
library(tidyr)
library(ggplot2)

theme_set(theme_minimal(base_size = 14))
```

This vignette explores Florida's assessment data from the FAST (Florida Assessment of Student Thinking) and FSA (Florida Standards Assessments) programs, covering grades 3-10 in ELA and grades 3-8 in Mathematics.

**Assessment Systems:**
- **FSA** (Florida Standards Assessments): 2015-2022
- **FAST** (Florida Assessment of Student Thinking): 2023-present

**Achievement Levels:**
- Level 1: Inadequate
- Level 2: Below Satisfactory
- Level 3: Satisfactory
- Level 4: Proficient
- Level 5: Mastery

Students at Level 3 or above are considered "on grade level" or proficient.

---

## 1. Just over half of Florida third graders read on grade level

In 2024, 55% of Florida 3rd graders scored at Level 3 or above on the FAST ELA Reading assessment.

```{r state-ela-g3}
assess_2024 <- fetch_assessment(2024, "ela", grade = 3, level = "district",
                                 tidy = FALSE, use_cache = TRUE)

state_g3 <- assess_2024 |>
  filter(is_state) |>
  select(end_year, subject, grade, n_tested, pct_proficient,
         pct_level_1, pct_level_2, pct_level_3, pct_level_4, pct_level_5)

state_g3
```

```{r state-ela-g3-chart}
levels_long <- state_g3 |>
  pivot_longer(cols = starts_with("pct_level"),
               names_to = "level",
               values_to = "pct") |>
  mutate(level = gsub("pct_level_", "Level ", level),
         level = factor(level, levels = paste("Level", 1:5)))

ggplot(levels_long, aes(x = level, y = pct, fill = level)) +
  geom_col() +
  geom_text(aes(label = paste0(pct, "%")), vjust = -0.3) +
  scale_fill_manual(values = c("#D7191C", "#FDAE61", "#FFFFBF", "#A6D96A", "#1A9641")) +
  labs(
    title = "Florida 3rd Grade ELA Achievement Levels (2024)",
    subtitle = "55% scored at Level 3 or above (proficient)",
    x = "Achievement Level",
    y = "Percent of Students"
  ) +
  theme(legend.position = "none")
```

---

## 2. Miami-Dade outperforms the state average

Despite being the largest district with over 25,000 3rd graders tested, Miami-Dade's 56% proficiency rate exceeds the state average.

```{r miami-dade}
large_districts <- assess_2024 |>
  filter(!is_state, n_tested > 5000) |>
  arrange(desc(n_tested)) |>
  select(district_name, n_tested, pct_proficient) |>
  head(10)

large_districts
```

```{r miami-dade-chart}
large_districts |>
  mutate(district_name = forcats::fct_reorder(district_name, pct_proficient)) |>
  ggplot(aes(x = pct_proficient, y = district_name)) +
  geom_col(fill = "#FF6600") +
  geom_vline(xintercept = 55, linetype = "dashed", color = "gray40") +
  annotate("text", x = 56, y = 1, label = "State Avg (55%)", hjust = 0, size = 3) +
  labs(
    title = "3rd Grade ELA Proficiency: Florida's Largest Districts",
    subtitle = "Districts with 5,000+ students tested",
    x = "Percent Proficient (Level 3+)",
    y = NULL
  )
```

---

## 3. Small districts lead in proficiency rates

Several smaller counties have the highest proficiency rates in the state, with some exceeding 70%.

```{r top-proficient}
top_proficient <- assess_2024 |>
  filter(!is_state, n_tested >= 100) |>
  arrange(desc(pct_proficient)) |>
  select(district_name, n_tested, pct_proficient) |>
  head(10)

top_proficient
```

```{r top-proficient-chart}
top_proficient |>
  mutate(district_name = forcats::fct_reorder(district_name, pct_proficient)) |>
  ggplot(aes(x = pct_proficient, y = district_name)) +
  geom_col(fill = "#1A9641") +
  geom_vline(xintercept = 55, linetype = "dashed", color = "gray40") +
  labs(
    title = "Florida's Highest-Performing Districts in 3rd Grade ELA",
    subtitle = "Minimum 100 students tested",
    x = "Percent Proficient (Level 3+)",
    y = NULL
  )
```

---

## 4. Rural Panhandle counties face challenges

Many North Florida rural counties have proficiency rates below 50%.

```{r low-proficient}
low_proficient <- assess_2024 |>
  filter(!is_state, n_tested >= 100) |>
  arrange(pct_proficient) |>
  select(district_name, n_tested, pct_proficient) |>
  head(10)

low_proficient
```

```{r low-proficient-chart}
low_proficient |>
  mutate(district_name = forcats::fct_reorder(district_name, -pct_proficient)) |>
  ggplot(aes(x = pct_proficient, y = district_name)) +
  geom_col(fill = "#D7191C") +
  geom_vline(xintercept = 55, linetype = "dashed", color = "gray40") +
  labs(
    title = "Florida Districts with Lowest 3rd Grade ELA Proficiency",
    subtitle = "Minimum 100 students tested",
    x = "Percent Proficient (Level 3+)",
    y = NULL
  )
```

---

## 5. Level 5 (Mastery) varies dramatically by district

Some districts have 3x the mastery rate of others.

```{r mastery-rate}
mastery <- assess_2024 |>
  filter(!is_state, n_tested >= 500) |>
  arrange(desc(pct_level_5)) |>
  select(district_name, n_tested, pct_level_5, pct_proficient) |>
  head(10)

mastery
```

```{r mastery-rate-chart}
mastery |>
  mutate(district_name = forcats::fct_reorder(district_name, pct_level_5)) |>
  ggplot(aes(x = pct_level_5, y = district_name)) +
  geom_col(fill = "#1A9641") +
  labs(
    title = "Districts with Highest Level 5 (Mastery) Rates",
    subtitle = "3rd Grade ELA, minimum 500 students tested",
    x = "Percent at Level 5 (Mastery)",
    y = NULL
  )
```

---

## 6. Proficiency rises through the grades for ELA

Upper grade students have higher ELA proficiency rates than younger students.

```{r grade-progression}
all_grades <- fetch_assessment(2024, "ela", grade = NULL, level = "district",
                                tidy = FALSE, use_cache = TRUE)

grade_state <- all_grades |>
  filter(is_state) |>
  select(grade, n_tested, pct_proficient) |>
  arrange(grade)

grade_state
```

```{r grade-progression-chart}
grade_state |>
  ggplot(aes(x = grade, y = pct_proficient)) +
  geom_col(fill = "#3399CC") +
  geom_text(aes(label = paste0(pct_proficient, "%")), vjust = -0.3) +
  labs(
    title = "Florida ELA Proficiency by Grade (2024)",
    subtitle = "State-level results",
    x = "Grade",
    y = "Percent Proficient (Level 3+)"
  )
```

---

## 7. Math proficiency peaks in Grade 4

Mathematics proficiency shows a different pattern, with younger grades performing better.

```{r math-grades}
math_all <- fetch_assessment(2024, "math", grade = NULL, level = "district",
                              tidy = FALSE, use_cache = TRUE)

math_state <- math_all |>
  filter(is_state) |>
  select(grade, n_tested, pct_proficient) |>
  arrange(grade)

math_state
```

```{r math-grades-chart}
math_state |>
  ggplot(aes(x = grade, y = pct_proficient)) +
  geom_col(fill = "#9933CC") +
  geom_text(aes(label = paste0(pct_proficient, "%")), vjust = -0.3) +
  labs(
    title = "Florida Math Proficiency by Grade (2024)",
    subtitle = "State-level results - FAST grades 3-8",
    x = "Grade",
    y = "Percent Proficient (Level 3+)"
  )
```

---

## 8. Over 216,000 third graders took the ELA assessment

Florida's massive scale makes even small percentage changes significant in terms of actual students.

```{r student-counts}
counts <- assess_2024 |>
  filter(is_state) |>
  mutate(
    n_proficient = round(pct_proficient / 100 * n_tested),
    n_not_proficient = n_tested - n_proficient
  ) |>
  select(n_tested, n_proficient, n_not_proficient, pct_proficient)

counts
```

Every 1% change represents over 2,000 students.

---

## 9. Broward edges out Hillsborough

Among large suburban districts, Broward County narrowly outperforms Hillsborough.

```{r broward-vs-hillsborough}
suburban <- assess_2024 |>
  filter(district_name %in% c("BROWARD", "HILLSBOROUGH", "ORANGE", "PALM BEACH")) |>
  select(district_name, n_tested, pct_proficient, pct_level_5)

suburban
```

```{r suburban-chart}
suburban |>
  pivot_longer(cols = c(pct_proficient, pct_level_5),
               names_to = "metric",
               values_to = "pct") |>
  mutate(metric = ifelse(metric == "pct_proficient", "Proficient (L3+)", "Mastery (L5)")) |>
  ggplot(aes(x = district_name, y = pct, fill = metric)) +
  geom_col(position = "dodge") +
  scale_fill_manual(values = c("#3399CC", "#1A9641")) +
  labs(
    title = "Major Suburban District Comparison",
    subtitle = "3rd Grade ELA 2024",
    x = NULL,
    y = "Percent",
    fill = "Level"
  )
```

---

## 10. Level 1 students need intensive intervention

Statewide, 22% of 3rd graders scored at Level 1 (Inadequate), requiring significant intervention.

```{r level-1-analysis}
level_1 <- assess_2024 |>
  filter(!is_state, n_tested >= 500) |>
  arrange(desc(pct_level_1)) |>
  select(district_name, n_tested, pct_level_1, pct_proficient) |>
  head(10)

level_1
```

```{r level-1-chart}
level_1 |>
  mutate(district_name = forcats::fct_reorder(district_name, pct_level_1)) |>
  ggplot(aes(x = pct_level_1, y = district_name)) +
  geom_col(fill = "#D7191C") +
  geom_vline(xintercept = 22, linetype = "dashed", color = "gray40") +
  annotate("text", x = 23, y = 1, label = "State Avg (22%)", hjust = 0, size = 3) +
  labs(
    title = "Districts with Highest Level 1 (Inadequate) Rates",
    subtitle = "3rd Grade ELA, minimum 500 students tested",
    x = "Percent at Level 1",
    y = NULL
  )
```

---

## 11. The proficiency gap between districts is 40+ percentage points

From top to bottom, Florida districts vary by over 40 percentage points in proficiency.

```{r proficiency-gap}
gap <- assess_2024 |>
  filter(!is_state, n_tested >= 100) |>
  summarize(
    min_prof = min(pct_proficient, na.rm = TRUE),
    max_prof = max(pct_proficient, na.rm = TRUE),
    gap = max_prof - min_prof,
    median_prof = median(pct_proficient, na.rm = TRUE)
  )

gap
```

```{r proficiency-distribution}
assess_2024 |>
  filter(!is_state, n_tested >= 100) |>
  ggplot(aes(x = pct_proficient)) +
  geom_histogram(bins = 20, fill = "#3399CC", color = "white") +
  geom_vline(xintercept = 55, linetype = "dashed", color = "#D7191C", linewidth = 1) +
  annotate("text", x = 56, y = 8, label = "State Avg", hjust = 0, color = "#D7191C") +
  labs(
    title = "Distribution of District Proficiency Rates",
    subtitle = "3rd Grade ELA 2024",
    x = "Percent Proficient",
    y = "Number of Districts"
  )
```

---

## 12. University lab schools lead the state

The UF, FSU, FAU, and FAMU lab schools consistently rank among the top performers.

```{r lab-schools}
lab_schools <- assess_2024 |>
  filter(grepl("LAB|UF |FSU |FAU |FAMU", district_name)) |>
  select(district_name, n_tested, pct_proficient, pct_level_5)

lab_schools
```

---

## 13. Central Florida districts perform near state average

Orlando-area districts like Orange and Osceola perform close to the state average.

```{r central-fl}
central <- assess_2024 |>
  filter(district_name %in% c("ORANGE", "OSCEOLA", "SEMINOLE", "LAKE", "VOLUSIA")) |>
  select(district_name, n_tested, pct_proficient) |>
  arrange(desc(pct_proficient))

central
```

---

## 14. The tidy format enables trend analysis

Using `tidy = TRUE` makes it easy to analyze achievement level distributions.

```{r tidy-format}
tidy_assess <- fetch_assessment(2024, "ela", grade = 3, level = "district",
                                 tidy = TRUE, use_cache = TRUE)

tidy_state <- tidy_assess |>
  filter(is_state) |>
  select(proficiency_level, proficiency_label, pct, n_students, is_proficient)

tidy_state
```

```{r tidy-chart}
tidy_state |>
  mutate(proficiency_label = factor(proficiency_label,
    levels = c("Inadequate", "Below Satisfactory", "Satisfactory", "Proficient", "Mastery"))) |>
  ggplot(aes(x = proficiency_label, y = n_students, fill = is_proficient)) +
  geom_col() +
  scale_y_continuous(labels = scales::comma) +
  scale_fill_manual(values = c("FALSE" = "#D7191C", "TRUE" = "#1A9641"),
                    labels = c("Below Grade Level", "On Grade Level")) +
  labs(
    title = "Florida 3rd Grade ELA Achievement Distribution",
    subtitle = "2024 FAST Results - Over 216,000 students",
    x = "Achievement Level",
    y = "Number of Students",
    fill = "Proficiency Status"
  )
```

---

## 15. Multi-year data shows assessment transition effects

Comparing FSA (2022) to FAST (2023-2024) shows the impact of assessment changes.

```{r multi-year}
multi_year <- tryCatch({
  fetch_assessment_multi(c(2022, 2023, 2024), "ela", grade = 3,
                         level = "district", tidy = FALSE, use_cache = TRUE) |>
    filter(is_state) |>
    select(end_year, assessment_system, n_tested, pct_proficient)
}, error = function(e) {
  message("Note: Some years may not be available")
  NULL
})

if (!is.null(multi_year)) {
  multi_year
}
```

```{r multi-year-chart, eval=!is.null(multi_year)}
if (!is.null(multi_year)) {
  multi_year |>
    ggplot(aes(x = factor(end_year), y = pct_proficient, fill = assessment_system)) +
    geom_col() +
    geom_text(aes(label = paste0(pct_proficient, "%")), vjust = -0.3) +
    scale_fill_manual(values = c("FSA" = "#3399CC", "FAST" = "#FF6600")) +
    labs(
      title = "Florida 3rd Grade ELA Proficiency Over Time",
      subtitle = "FSA (2022) vs FAST (2023-2024)",
      x = "School Year",
      y = "Percent Proficient",
      fill = "Assessment"
    )
}
```

---

## Data Notes

**Assessment Data Source:** Florida Department of Education (FLDOE)
https://www.fldoe.org/accountability/assessments/k-12-student-assessment/results/

**Available Years:**
- 2019, 2022-2025 (no 2020/2021 due to COVID-19 testing waiver)

**Subjects:**
- ELA Reading: Grades 3-10
- Mathematics: Grades 3-8

**Suppression Rules:**
- Results may be suppressed for small n-sizes to protect student privacy

---

## Summary

Florida's assessment data reveals significant patterns:

- **Scale**: Over 216,000 3rd graders tested, making Florida one of the largest testing programs
- **Proficiency**: 55% of 3rd graders read on grade level (Level 3+)
- **Equity gaps**: 40+ percentage point gap between highest and lowest performing districts
- **Regional patterns**: Lab schools and affluent suburbs outperform rural Panhandle counties
- **Intervention needs**: 22% of 3rd graders at Level 1 need intensive support
- **Grade trends**: ELA proficiency rises with grade level; Math proficiency peaks early

These patterns inform policy decisions about literacy interventions, resource allocation, and accountability.

---

*Data sourced from the Florida Department of Education.*

---

```{r session-info}
sessionInfo()
```
